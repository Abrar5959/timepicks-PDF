
<?php
ini_set('display_errors', 1);
ini_set('display_startup_errors', 1);
error_reporting(E_ALL);
$sumSmallValues=array();
$name = 'Haywood Technologie FinanciÃ¨re Inc.';
$totalProjects = '30';
$financialPerson = 'Makram Elkebti';
$technicalPerson = 'Makram Elkebti';
$tel1 = '(514) 962-0499';
$tel2 = '(514) 962-0499';
$BN = '202305312344334';
$to_date    = '2023053';
$from_date  = '2023053';
$project_title = 'Log less data rollback-risk management';
$project_start_date = '202303';
$completion_date = '202303';
$field_of_science = '1.02.01';
$technology_code = 'Computer sciences';
$previously_claimed_project = "5";
$first_claimed_project = "5";
$collaboration_with_other_businesses = "5";
$overcome_scientific_uncertainties = "The rapid advancement of technology in recent years has fundamentally transformed various aspects of our lives. From communication to healthcare, education to entertainment, the digital age has brought about unprecedented changes that continue to shape our world. One of the most notable developments is the widespread adoption of smartphones, which have become ubiquitous tools for staying connected and accessing information. Smartphones have revolutionized communication by making it easier than ever to reach out to friends, family, and colleagues regardless of geographical boundaries. Social media platforms and messaging apps have allowed people to stay in constant contact, sharing their thoughts, experiences, and photos with a global audience. Additionally, the availability of video calls has bridged the gap between distant loved ones, providing a sense of connection during challenging times. In the field of healthcare, technology has played a crucial role in improving patient care and diagnostics.";
$work_performed_tax_year = "Artificial intelligence (AI) has captivated the imagination of scientists, engineers, and writers for decades. It represents our quest to replicate human intelligence in machines, a journey that has transformed our world. Today, AI is an integral part of our daily lives, touching everything from our smartphones to our healthcare systems. As AI seeks to create systems and machines capable of tasks requiring human-like intelligence. These tasks encompass problem-solving, language comprehension, pattern recognition, and data-driven decision-making. AI's development thrives on the surge in computing power and the abundance of data, both crucial for training AI algorithms. Machine learning, a subset of AI, has gained immense popularity recently. It involves training algorithms to improve their performance on specific tasks by learning from data. This approach has led to breakthroughs in areas such as image and speech recognition, natural language processing, and autonomous vehicles. Machine learning powers recommendation systems, virtual assistants, and predictive analytics in diverse industries. Deep learning, a subfield of machine learning, has been particularly influential. It employs artificial neural networks inspired by the human brain. Deep learning has revolutionized computer vision, enabling machines to identify objects in images and videos with remarkable accuracy. It underpins facial recognition, self-driving cars, and medical image analysis. The impact of AI on healthcare is profound. Medical professionals increasingly rely on AI for diagnostics, drug discovery, and personalized treatments. Machine learning analyzes extensive medical data to detect diseases earlier and more accurately. In drug discovery, AI accelerates the identification of potential candidates, reducing costs and speeding up development. Natural language processing is another exciting AI application. It enables machines to understand, interpret, and generate human language. Chatbots and virtual assistants simplify interactions with computers. NLP also plays a crucial role in sentiment analysis, allowing companies to gauge public opinion through social media and customer reviews. The integration of AI into industries poses challenges and ethical concerns. AI in decision-making raises questions about bias and fairness, as algorithms may inherit biases present in training data. Ensuring fairness and transparency is an ongoing challenge requiring regulation and oversight. Privacy is a significant concern. Collecting and analyzing personal data for AI applications prompts questions about data security and individual rights. Striking a balance between AI's benefits and privacy protection demands collaboration between policymakers and technology companies. Despite challenges, AI's potential to drive innovation and improve our lives is undeniable. From autonomous vehicles enhancing road safety to AI-driven healthcare solutions revolutionizing patient care, the possibilities are vast. Ethical principles, accountability, and ongoing research are essential as we develop AI to address complex issues. In conclusion, artificial intelligence, once a theoretical concept, has become a practical reality shaping our world. Its impact spans industries, from healthcare and finance to entertainment and transportation.";
$scientific_advancements_attempt_to_acheive_result = "The rapid advancement of technology in recent years has fundamentally transformed various aspects of our lives. From communication to healthcare, education to entertainment, the digital age has brought about unprecedented changes that continue to shape our world. One of the most notable developments is the widespread adoption of smartphones, which have become ubiquitous tools for staying connected and accessing information. Smartphones have revolutionized communication by making it easier than ever to reach out to friends, family, and colleagues regardless of geographical boundaries. Social media platforms and messaging apps have allowed people to stay in constant contact, sharing their thoughts, experiences, and photos with a global audience. Additionally, the availability of video calls has bridged the gap between distant loved ones, providing a sense of connection during challenging times. In the field of healthcare, technology has played a crucial role in improving patient care and diagnostics.";
$employee_directly_involved='5';
$external_consultant="5";
$claiming_salary="5";
$claiming_expenditures="5";
$claiming_expenditures_performed_by_other_peoples="5";
$resources_allocate_record='5';
$design_architecture_souceCode="5";
$trial_run_record="5";
$sample_other_Artefacts="5";
$part2_name1='Makram El Kebti, Zubair Ali Mansoor';
$part2_name2='Islam Ahmed';
$firm="Les entreprises Timepicks";
$directly_involved_name=array('Zubair Ali Mansoor','Makram El Kebti','Makram El Kebti');
$directly_involved_Qualifications=array('MSc. Comp. Sci, 15 years exp. In Soft/2 IEEE publications/Lead Engineer','Bach. Comm, 20 years exp. in HFT system development/President','Bach. Comm, 20 years exp. in HFT system development/President');
$proxy_method="5";
$unspecified_employee = 158752;
$specified_employee = 13505;

// Format the numbers with commas
$formatted_unspecified_employee = number_format($unspecified_employee);
$formatted_specified_employee = number_format($specified_employee);
$total = $unspecified_employee + $specified_employee;
// Format the result with commas
$formatted_total1 = number_format($total);
$provincial_government_assistance_for_expenditures=36677;
$formatted_provincial_government_assistance_for_expenditures = number_format($provincial_government_assistance_for_expenditures);
$subTotal=$total-$provincial_government_assistance_for_expenditures;
$formatted_subTotal=number_format($subTotal);
$un_traditional_method=94741;
$formatted_un_traditional_method = number_format($un_traditional_method);
$total_expenditures_transferred_to_you=$un_traditional_method+$total;
$formatted_total_expenditures_transferred_to_you = number_format($total_expenditures_transferred_to_you);
$provincial_government_assistance=36677;
$formatted_provincial_government_assistance=number_format($provincial_government_assistance);
$Qualified_SR_ED_expenditures=$total_expenditures_transferred_to_you-$provincial_government_assistance;
$formatted_Qualified_SR_ED_expenditures=number_format($Qualified_SR_ED_expenditures);

$specified_employee_name=array('Makram El Kebti','Employee 2','Employee 3','Employee 4','Employee 5');
$specified_employee_salary=array(30,40,50,60,70);
$percentage_of_time_spent=array('44','55','66','77','88');
$a=array(23,23,23,23,23);
$b=array(34,33,34,34,34);
$identification_code=array('Log less data rollback-risk management','Multi-Tenant Cus','Multiplex time series compression','Log less data rollback-risk management','Multi-Tenant Cus');
$salray_in_tax_year=array(1000,2000,3000,4000,5000);
$total_salary_tax_years=0;
foreach($salray_in_tax_year as $amount)
{
    $total_salary_tax_years=$total_salary_tax_years+$amount;
}
$line307=30;
$line309=400;
$line340=400;
$line345=300;
$line370=400;
$expenditure_in_canada=4900;
$expenditure_in_canada=$expenditure_in_canada-($line307+$line309+$line340+$line345+$line370);
$percentage_of_distribution=100.000;
$Scientists_and_engineers=2;
$Technologists_and_technicians=30;
$Managers_and_administrator=30;
$Experimental_development=5;
$part8_claim_checkList=array(5,5,5,5,5,5,5,5,5);
$claim_prepare=5;
$name_claim_prepare=array('Les entreprise timepicks','Les entreprise timepicks','Les entreprise timepicks','Les entreprise timepicks','Les entreprise timepicks','Les entreprise timepicks','Les entreprise timepicks','Les entreprise timepicks','Les entreprise timepicks','Les entreprise timepicks');
$business_no=array('84510 8083 RT0001','84510 8083 RT0001','84510 8083 RT0001','84510 8083 RT0001','84510 8083 RT0001','84510 8083 RT0001','84510 8083 RT0001','84510 8083 RT0001','84510 8083 RT0001','84510 8083 RT0001');
$billing_aggrement_code=array(4,4,4,4,4,4,4,4,4,4);
$billing_percentage=array(8000.00,8000.00,8000.00,8000.00,8000.00,8000.00,8000.00,8000.00,8000.00,8000.00);
$other_bill_Arrangements=array('etc','etc','etc','etc','etc','etc','etc','etc','etc','etc');
$total_Fee_paid_payable=array(8000,8000,8000,8000,8000,8000,8000,8000,8000,8000);
$signing_officer_of_the_corporation='Makram Elkebti';
$person_complete_the_form='Dufour Charbonneau Brunet & AssociÃ©s Inc.';


function calculateAmount($valueInColumn2, $percentageInColumn3,$a=0,$b=0,$get_smaller_amount) {
    if($get_smaller_amount=='off')
    {
        return number_format($valueInColumn2 * ($percentageInColumn3 / 100));
    }
    else{
        return getSmallerAmount($a,$b,$valueInColumn2 * ($percentageInColumn3 / 100));
    }
}
function calculateResult($A, $B) {
    return (2.5 * $A * $B) / 365;
}
function getSmallerAmount($a,$b,$c)
{
    global $sumSmallValues;
    $column5= (2.5 * $a * $b) / 365;
    $c4=$c;
    if($column5>$c4)
    {
        // echo "hello";
        array_push($sumSmallValues,$c4);
        return number_format($c4);
    }
    else{
        // echo "hi";
        array_push($sumSmallValues,$column5);
        return number_format($column5);
    }
}
function sumValues($sumSmallValues,$sum=0)
{
    foreach ($sumSmallValues as $value) {
        $sum += $value;
    }
    return $sum;
}

include('extension.php');

// include('../fpdf/fpdf.php');
$pdf = new PDFi();
// set the source file
$pdf->setSourceFile("templates/template.pdf");

// import page 1
$tplId = $pdf->importPage(1);

$pdf->SetMargins(0, 0, 0);
// add a page
$pdf->AddPage("P", "letter", 0);

// use the imported page and place it at point 10,10 with a width of 100 mm
$pdf->useTemplate($tplId);


$pdf->SetFont('Arial', '', 9);

insert_cell($pdf, $X = 15.5, $Y = 125, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($name, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
insert_cell($pdf, $X = 25, $Y = $pdf->GetY() + 37.5, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($totalProjects, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
insert_cell($pdf, $X = 15.5, $Y = $pdf->GetY() + 12.7, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($financialPerson, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
insert_cell($pdf, $X = 115, $Y = $pdf->GetY(), $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($tel1, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
insert_cell($pdf, $X = 15.5, $Y = $pdf->GetY() + 12.7, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($technicalPerson, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
insert_cell($pdf, $X = 115, $Y = $pdf->GetY(), $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($tel2, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);

$x = 119.8;
for ($i = 0; $i < strlen($BN); $i++) {
    insert_cell($pdf, $X = $x, $Y = 129.7, $CellWidth = 5.05, $CellHeight = 5, $text = mb_convert_encoding($BN[$i], 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'C', $fill = false);
    $x = $pdf->GetX();
}
$x = 24.3;
for ($i = 0; $i < strlen($from_date); $i++) {
    insert_cell($pdf, $X = $x, $Y = 144, $CellWidth = 4.3, $CellHeight = 5, $text = mb_convert_encoding($from_date[$i], 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'C', $fill = false);
    $x = $pdf->GetX();
}
$x = 62.2;
for ($i = 0; $i < strlen($to_date); $i++) {
    insert_cell($pdf, $X = $x, $Y = 144, $CellWidth = 4.3, $CellHeight = 5, $text = mb_convert_encoding($to_date[$i], 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'C', $fill = false);
    $x = $pdf->GetX();
}



$tplId = $pdf->importPage(2);
$pdf->SetMargins(0, 0, 0);
// add a page
$pdf->AddPage("P", "letter", 0);

// use the imported page and place it at point 10,10 with a width of 100 mm
$pdf->useTemplate($tplId);
$pdf->SetFont('Arial', '', 9);
insert_cell($pdf, $X = 15, $Y = 34.2, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($project_title, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
$x = 23;
for ($i = 0; $i < strlen($project_start_date); $i++) {
    insert_cell($pdf, $X = $x, $Y = 43.8, $CellWidth = 5.1, $CellHeight = 5, $text = mb_convert_encoding($project_start_date[$i], 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'C', $fill = false);
    $x = $pdf->GetX();
}
$x = 84.7;
for ($i = 0; $i < strlen($completion_date); $i++) {
    insert_cell($pdf, $X = $x, $Y = $pdf->GetY(), $CellWidth = 5.1, $CellHeight = 5, $text = mb_convert_encoding($completion_date[$i], 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'C', $fill = false);
    $x = $pdf->GetX();
}
insert_cell($pdf, $X = 132, $Y = $pdf->GetY() + 3, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($field_of_science . '      ' . $technology_code, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
// Set the line position and length
$x = 147.5; // X-coordinate
$y1 = 46.3; // Starting Y-coordinate
$y2 = 50.8; // Ending Y-coordinate
$lineWidth = 0.2; // Line width (adjust as needed)

// Set the line color (0-255 for RGB)
$pdf->SetDrawColor(0, 0, 0); // Black

// Draw the vertical line
$pdf->SetLineWidth($lineWidth);
$pdf->Line($x, $y1, $x, $y2);
$pdf->SetFont('ZapfDingbats', '', 10);
if (isset($previously_claimed_project)) {
    insert_cell($pdf, $X = 17.3, $Y = $pdf->GetY() + 10, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($previously_claimed_project, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
}
if (isset($previously_claimed_project)) {
    insert_cell($pdf, $X = 102.5, $Y = $pdf->GetY(), $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($previously_claimed_project, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
}
if (isset($collaboration_with_other_businesses)) {
    insert_cell($pdf, $X = 176.1, $Y = $pdf->GetY() + 7.7, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($collaboration_with_other_businesses, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
} else {
    insert_cell($pdf, $X = 192, $Y = $pdf->GetY() + 7.5, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($collaboration_with_other_businesses, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
}

$pdf->SetFont('Arial', '', 6);
insert_multicell($pdf, $X = 8, $Y = 112, $CellWidth = 200, $CellHeight = 5, $text = $overcome_scientific_uncertainties, $border = 0, $alignment = 'L', $fill = false);
insert_multicell($pdf, $X = 8, $Y = 144, $CellWidth = 200, $CellHeight = 5, $text = $work_performed_tax_year, $border = 0, $alignment = 'L', $fill = false);
insert_multicell($pdf, $X = 8, $Y = 233, $CellWidth = 200, $CellHeight = 5, $text = $scientific_advancements_attempt_to_acheive_result, $border = 0, $alignment = 'L', $fill = false);


$tplId = $pdf->importPage(3);
$pdf->SetMargins(0, 0, 0);
// add a page
$pdf->AddPage("P", "letter", 0);

// use the imported page and place it at point 10,10 with a width of 100 mm
$pdf->useTemplate($tplId);
$pdf->SetFont('ZapfDingbats', '', 10);
insert_cell($pdf, $X = 16, $Y = 31.8, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($employee_directly_involved, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
insert_cell($pdf, $X = 16, $Y = $pdf->GetY()+17, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($external_consultant, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
insert_cell($pdf, $X = 194.8, $Y = $pdf->GetY()+36.7, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($claiming_salary, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
insert_cell($pdf, $X = 194.8, $Y = $pdf->GetY()+5.4, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($claiming_expenditures, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
insert_cell($pdf, $X = 194.8, $Y = $pdf->GetY()+5.4, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($claiming_expenditures_performed_by_other_peoples, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
insert_cell($pdf, $X = 16, $Y =$pdf->GetY()+40.2, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($resources_allocate_record, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
insert_cell($pdf, $X = 101.2, $Y =$pdf->GetY()+10, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($sample_other_Artefacts, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
insert_cell($pdf, $X = 16, $Y =$pdf->GetY()+5, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($design_architecture_souceCode, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
insert_cell($pdf, $X = 16, $Y =$pdf->GetY()+5, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($trial_run_record, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);

$pdf->SetFont('Arial', '', 8);
insert_cell($pdf, $X = 82.8,    $Y = 33.9, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($part2_name1, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
insert_cell($pdf, $X = 82.8,    $Y = $pdf->GetY()+16.9, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($part2_name2, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
insert_cell($pdf, $X = 164.5,   $Y = $pdf->GetY(), $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($firm, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
$y= $pdf->GetY()+14.3;
for($i=0;$i<3;$i++)
{
    insert_cell($pdf, $X = 12.5,    $Y = $y, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($directly_involved_name[$i], 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
    insert_cell($pdf, $X = 109,     $Y = $pdf->GetY(), $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($directly_involved_Qualifications[$i], 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
    $y=$y+6.3;
}
$tplId = $pdf->importPage(4);
$pdf->SetMargins(0, 0, 0);
// add a page
$pdf->AddPage("P", "letter", 0);

// use the imported page and place it at point 10,10 with a width of 100 mm
$pdf->useTemplate($tplId);
$pdf->SetFont('ZapfDingbats', '', 10);
insert_cell($pdf, $X = 17, $Y = 35, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($proxy_method, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
$pdf->SetFont('Arial', '', 9);
insert_cell($pdf, $X = 194, $Y = $pdf->GetY()+33, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($formatted_unspecified_employee, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
insert_cell($pdf, $X = 194, $Y = $pdf->GetY()+4.9, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($formatted_specified_employee, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
insert_cell($pdf, $X = 194, $Y = $pdf->GetY()+4.8, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($formatted_total1, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
insert_cell($pdf, $X = 194, $Y = $pdf->GetY()+58.6, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($formatted_total1, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
insert_cell($pdf, $X = 194, $Y = $pdf->GetY()+26.4, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($formatted_total1, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
insert_cell($pdf, $X = 194, $Y = $pdf->GetY()+10.1, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($formatted_provincial_government_assistance_for_expenditures, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
insert_cell($pdf, $X = 194, $Y = $pdf->GetY()+24, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($formatted_subTotal, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
insert_cell($pdf, $X = 194, $Y = $pdf->GetY()+28.5, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($formatted_subTotal, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
insert_cell($pdf, $X = 194, $Y = $pdf->GetY()+7.1, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($formatted_subTotal, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);



$tplId = $pdf->importPage(5);
$pdf->SetMargins(0, 0, 0);
// add a page
$pdf->AddPage("P", "letter", 0);

// use the imported page and place it at point 10,10 with a width of 100 mm
$pdf->useTemplate($tplId);
insert_cell($pdf, $X = 194, $Y = 25.6, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($formatted_total1, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
insert_cell($pdf, $X = 194, $Y = $pdf->GetY()+15.7, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($formatted_un_traditional_method, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
insert_cell($pdf, $X = 194, $Y = $pdf->GetY()+10.4, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($formatted_total_expenditures_transferred_to_you, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
insert_cell($pdf, $X = 194, $Y = $pdf->GetY()+9.2, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($formatted_provincial_government_assistance, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
insert_cell($pdf, $X = 194, $Y = $pdf->GetY()+68.3, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($formatted_Qualified_SR_ED_expenditures, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
insert_cell($pdf, $X = 194, $Y = $pdf->GetY()+15.4, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($formatted_Qualified_SR_ED_expenditures, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);


$tplId = $pdf->importPage(6);
$pdf->SetMargins(0, 0, 0);
$pdf->SetAutoPageBreak(0);
// add a page
$pdf->AddPage("P", "letter", 0);

// use the imported page and place it at point 10,10 with a width of 100 mm
$pdf->useTemplate($tplId);
$pdf->SetFont('Arial', '', 8);

insert_cell($pdf, $X = 194, $Y = 38.4, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($formatted_unspecified_employee, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
insert_cell($pdf, $X = 194, $Y = $pdf->GetY()+17.1, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($formatted_unspecified_employee, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
$y=$pdf->GetY()+52.3;
for($i=0;$i<5;$i++)
{
    insert_cell($pdf, $X = 9.9, $Y = $y, $CellWidth = 32.2, $CellHeight = 5, $text = mb_convert_encoding($specified_employee_name[$i], 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'C', $fill = false);
    insert_cell($pdf, $X = 42.7, $Y = $pdf->GetY(), $CellWidth = 32.2, $CellHeight = 5, $text = mb_convert_encoding(number_format($specified_employee_salary[$i]), 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
    insert_cell($pdf, $X = 75, $Y = $pdf->GetY(), $CellWidth = 20, $CellHeight = 5, $text = mb_convert_encoding(number_format($percentage_of_time_spent[$i]), 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
    insert_cell($pdf, $X = 97, $Y = $pdf->GetY(), $CellWidth = 26.4, $CellHeight = 5, $text = calculateAmount($specified_employee_salary[$i],$percentage_of_time_spent[$i],'','','off'), $border = 0, $alignment = 'R', $fill = false);
    insert_cell($pdf, $X = 124.3, $Y = $pdf->GetY(), $CellWidth = 24.8, $CellHeight = 5, $text = mb_convert_encoding(number_format(calculateResult($a[$i],$b[$i])), 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
    insert_cell($pdf, $X = 149.8, $Y = $pdf->GetY(), $CellWidth = 21.2, $CellHeight = 5, $text = calculateAmount($specified_employee_salary[$i],$percentage_of_time_spent[$i],$a[$i],$b[$i],'on'), $border = 0, $alignment = 'R', $fill = false);
    $y=$y+7.4;
}

insert_cell($pdf, $X = 149.8, $Y = $pdf->GetY()+7.6, $CellWidth = 21.2, $CellHeight = 5, $text = mb_convert_encoding(number_format(sumValues($sumSmallValues)), 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
insert_cell($pdf, $X = 185.5, $Y = $pdf->GetY()-2.9, $CellWidth = 21.2, $CellHeight = 5, $text = mb_convert_encoding(number_format(sumValues($sumSmallValues)), 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
insert_cell($pdf, $X = 185.5, $Y = $pdf->GetY()+6.3, $CellWidth = 21.2, $CellHeight = 5, $text = mb_convert_encoding(number_format(sumValues($sumSmallValues)+$unspecified_employee), 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
$pdf->SetFont('Arial', '', 7);
$y=$pdf->GetY()+71.9;
for($i=0;$i<count($identification_code);$i++)
{
    insert_cell($pdf, $X = 15, $Y = $y, $CellWidth = 52.2, $CellHeight = 5, $text = mb_convert_encoding($identification_code[$i], 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
    insert_cell($pdf, $X = 67.5, $Y = $pdf->GetY(), $CellWidth = 33.6, $CellHeight = 5, $text = mb_convert_encoding(number_format($salray_in_tax_year[$i]), 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
    $y=$y+7.4;
}

insert_cell($pdf, $X = 67.5, $Y = $pdf->GetY()+6.3, $CellWidth = 33.6, $CellHeight = 5, $text = mb_convert_encoding(number_format($total_salary_tax_years), 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);


$tplId = $pdf->importPage(7);
$pdf->SetMargins(0, 0, 0);
// add a page
$pdf->AddPage("P", "letter", 0);

// use the imported page and place it at point 10,10 with a width of 100 mm
$pdf->useTemplate($tplId);
$pdf->SetFont('Arial', '', 9);
insert_cell($pdf, $X = 194, $Y = 18, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding(number_format($expenditure_in_canada), 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
insert_cell($pdf, $X = 158.5, $Y = $pdf->GetY()+22, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding(number_format($percentage_of_distribution), 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);

insert_cell($pdf, $X = 194, $Y = $pdf->GetY()+58.5, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding(number_format($Scientists_and_engineers), 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
insert_cell($pdf, $X = 194, $Y = $pdf->GetY()+5.7, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding(number_format($Technologists_and_technicians), 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
insert_cell($pdf, $X = 194, $Y = $pdf->GetY()+5.7, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding(number_format($Managers_and_administrator), 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);

$pdf->SetFont('ZapfDingbats', '', 10);
insert_cell($pdf, $X = 117.7, $Y = $pdf->GetY()-21.3, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($Experimental_development, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
$y=$pdf->GetY()+54.5;
for($i=0;$i<9;$i++)
{
    insert_cell($pdf, $X = 183.3, $Y = $y, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($part8_claim_checkList[$i], 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
    if($i==4)
    {
        $y=$y+7.8;        
    }
    else if($i==3)
    {
        $y=$y+0.3;        
    }
    $y=$y+5.7;
}

$tplId = $pdf->importPage(8);
$pdf->SetMargins(0, 0, 0);
// add a page
$pdf->AddPage("P", "letter", 0);

// use the imported page and place it at point 10,10 with a width of 100 mm
$pdf->useTemplate($tplId);
$pdf->SetFont('ZapfDingbats', '', 10);
insert_cell($pdf, $X = 12.4, $Y = 46, $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($claim_prepare, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
$pdf->SetFont('Arial', '', 7);
$y=$pdf->GetY()+59;
for($i=0;$i<10;$i++)
{
    insert_cell($pdf, $X = 12.4, $Y = $y, $CellWidth = 35, $CellHeight = 5, $text = mb_convert_encoding($name_claim_prepare[$i], 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
    insert_cell($pdf, $X = 58, $Y = $pdf->GetY(), $CellWidth = 35, $CellHeight = 5, $text = mb_convert_encoding($business_no[$i], 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
    insert_cell($pdf, $X = 93, $Y = $pdf->GetY(), $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($billing_aggrement_code[$i], 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
    insert_cell($pdf, $X = 115, $Y = $pdf->GetY(), $CellWidth = 13, $CellHeight = 5, $text = mb_convert_encoding($billing_percentage[$i], 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
    insert_cell($pdf, $X = 129, $Y = $pdf->GetY(), $CellWidth = 50.5, $CellHeight = 5, $text = mb_convert_encoding('', 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'C', $fill = false);
    insert_cell($pdf, $X = 183.5, $Y = $pdf->GetY(), $CellWidth = 25, $CellHeight = 5, $text = mb_convert_encoding(number_format($total_Fee_paid_payable[$i]), 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);
    $y=$y+4.4;
}
$total_Fee_paid_payable_sum=0;
foreach($total_Fee_paid_payable as $value)
{
    $total_Fee_paid_payable_sum=$total_Fee_paid_payable_sum+$value;
}
insert_cell($pdf, $X = 183.5, $Y = $pdf->GetY()+5, $CellWidth = 25, $CellHeight = 5, $text = mb_convert_encoding(number_format($total_Fee_paid_payable_sum), 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'R', $fill = false);

insert_cell($pdf, $X = 20, $Y = $pdf->GetY()+47.5, $CellWidth = 15, $CellHeight = 5, $text = mb_convert_encoding($signing_officer_of_the_corporation, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);

$tplId = $pdf->importPage(9);
$pdf->SetMargins(0, 0, 0);
// add a page
$pdf->AddPage("P", "letter", 0);

// use the imported page and place it at point 10,10 with a width of 100 mm
$pdf->useTemplate($tplId);
$pdf->SetFont('Arial', '', 8);
insert_cell($pdf, $X = 15.2, $Y = 27.3, $CellWidth = 15, $CellHeight = 5, $text = mb_convert_encoding($signing_officer_of_the_corporation, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);
insert_cell($pdf, $X = 15.2, $Y = $pdf->GetY()+15.2, $CellWidth = 15, $CellHeight = 5, $text = mb_convert_encoding($person_complete_the_form, 'ISO-8859-1', 'UTF-8'), $border = 0, $alignment = 'L', $fill = false);

$pdf->Output();